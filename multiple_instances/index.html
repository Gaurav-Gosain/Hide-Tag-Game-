<canvas id="ctx" style="border:1px solid yellow;" src="https://i.ibb.co/HtZLGRJ/testmap.png" ></canvas>
<script src="https://cdn.socket.io/socket.io-1.4.5.js"></script>
<script>
       // window.onload = function() {
    var img = new Image();
    img.src = "https://i.ibb.co/HtZLGRJ/testmap.png";
            
    var canvas = document.getElementById("ctx");
    canvas.width = window.innerWidth-30;
    canvas.height =canvas.width/2;
    //canvas.style.background = 'red';
    var ctx = canvas.getContext("2d");
    ctx.fillStyle = "white";
/*fillRect is a function that draws the background of the game i.e black in our case.
  fillRect takes 4 arguments : 
  (a,b,c,d) : 
   a = x coordinate of starting pixel
   b = y coordinate of starting pixel
   c = width of the rectange we want to draw (left to right)
   d = height of the rectangle we want to draw (top to bottom) */
    //ctx.fillRect(0, 0, canvas.width, canvas.height);
    //canvas.fillStyle = "white"; 
        //}


   
    var socket = io();
       
    socket.on('newPositions',function(data){
        ctx.clearRect(0,0,canvas.width,canvas.height);
        ctx.drawImage(img, 0, 0,img.width,img.height,0,0,canvas.width,canvas.height);
        for(var  i= 0 ; i < data.length; i++){
            var collision = false;
            if(data[i].x<=0){
                data[i].x = 0;
              //  socket.emit('collision',{x:0,y = data[i].y, id = i});
              ctx.fillRect(data[i].x,data[i].y,20,20)     ;
              collision = true;
             // break;
            }
            if (data[i].x + 20 >= canvas.width) {
                data[i].x = canvas.width - 20;
               // socket.emit('collision',{x: canvas.width - 20,y = data[i].y, id = i});
               ctx.fillRect(data[i].x,data[i].y,20,20)     ;
               collision = true;
              // break;
            }
        
            if (data[i].y <= 0) {
                data[i].y = 0;
               // socket.emit('collision',{x: data[i].x,y = 0, id = i});
               ctx.fillRect(data[i].x,data[i].y,20,20)     ;
               collision = true;
              // break;
              }
            if (data[i].y + 20 >= canvas.height) {
                data[i].y = canvas.height - 20;
               // socket.emit('collision',{x: data[i].x,y:canvas.height - 20, id:i});
               ctx.fillRect(data[i].x,data[i].y,20,20)     ;
              // break;
              collision = true;
              }
            if(collision == false)
              ctx.fillRect(data[i].x,data[i].y,20,20)     ;
            }
      // for(var i = 0 ; i < data.length; i++){
       //     ctx.fillRect(data[i].x,data[i].y,20,20)     ;
      //      
      //  }
    });
 
    document.onkeydown = function(event){
        if(event.keyCode === 68)    //d
            socket.emit('keyPress',{inputId:'right',state:true});
        else if(event.keyCode === 83)   //s
            socket.emit('keyPress',{inputId:'down',state:true});
        else if(event.keyCode === 65) //a
            socket.emit('keyPress',{inputId:'left',state:true});
        else if(event.keyCode === 87) // w
            socket.emit('keyPress',{inputId:'up',state:true});
           
    }
    document.onkeyup = function(event){
        if(event.keyCode === 68)    //d
            socket.emit('keyPress',{inputId:'right',state:false});
        else if(event.keyCode === 83)   //s
            socket.emit('keyPress',{inputId:'down',state:false});
        else if(event.keyCode === 65) //a
            socket.emit('keyPress',{inputId:'left',state:false});
        else if(event.keyCode === 87) // w
            socket.emit('keyPress',{inputId:'up',state:false});
    }
   
</script>